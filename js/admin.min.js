(()=>{"use strict";let e,t=function(e){"undefined"!=typeof tinymce&&(tinymce.remove(),document.querySelectorAll(".entry-content .wp-editor-area").forEach((e=>{window.tinyMCE.execCommand("mceAddEditor",!1,e.id)}))),window.document.dispatchEvent(new Event("DOMContentLoaded",{bubbles:!0,cancelable:!0})),document.querySelectorAll(".wp-switch-editor").forEach((e=>e.addEventListener("click",(t=>{let l=e.closest(".wp-editor-wrap").querySelector(".wp-editor-area"),n=e.closest(".wp-editor-wrap").querySelector(".mce-panel");l.style.visibility="unset",t.target.matches(".switch-tmce")?(n.style.display="block",l.style.display="none"):(n.style.display="none",l.style.display="block")})))),document.querySelectorAll("select:not(.nonice,.swal2-select)").forEach((function(e){Main.attachNiceSelect(e)}));const t=new Event("scriptsloaded");e.dispatchEvent(t)},l=function(n){if(null==n)return;0==e.length&&t(n);let r=e.shift();if(null!=r)if("SCRIPT"==r.tagName&&null==document.getElementById(r.id)){var o=document.createElement("script");""==r.type?o.type="text/javascript":o.type=r.type,""!=r.src?o.src=r.src:o.innerHTML=r.innerHTML,o.id=r.id;try{document.head.appendChild(o)}catch(e){console.error(e)}e.length>0?""!=r.src?o.addEventListener("load",l.bind(null,n)):l(n):""!=r.src?o.addEventListener("load",t.bind(null,n)):t(n)}else e.length>0?l(n):t(n);else t(n)};function n(e){Array.from(e.options).forEach((function(e){e.defaultSelected=!1}))}console.log("Forms.js is loaded");let r=[];function o(e,t=!0){!function(e){"undefined"!=typeof tinymce&&e.querySelectorAll(".wp-editor-area").forEach((e=>{let t=tinymce.get(e.id);null!=t&&(r[e.id]=t.settings,t.save(),t.remove())}))}(e);let l=e.cloneNode(!0);return l.querySelectorAll(".nice-select").forEach((e=>e.remove())),e.querySelectorAll(".wp-editor-area").forEach((e=>{null!=r[e.id]&&tinymce.init(r[e.id])})),t&&l.querySelectorAll("input,select,textarea").forEach((e=>{"checkbox"==e.type||"radio"==e.type?e.checked=!1:"hidden"!=e.type&&(e.value=""),"select-one"==e.type&&n(e)})),l.querySelectorAll("select").forEach((e=>{n(e),Main.attachNiceSelect(e)})),l}function a(e){let t=o(e);t.querySelectorAll(".upload-files").forEach((function(e){e.dataset.index=nodeNr})),t.querySelectorAll(".documentpreview").forEach((function(e){e.innerHTML=""}));let l=0;if(t.querySelectorAll("select").forEach((t=>{let n=e.getElementsByTagName("select")[l].selectedIndex;null!=t.options[n]&&(t.options[n].style.display="none"),Main.attachNiceSelect(t),l++})),null==e.querySelector(".remove")&&null==t.querySelector(".remove")){let l='<button type="button" class="remove button" style="flex: 1;">-</button>';e.querySelector(".buttonwrapper").insertAdjacentHTML("beforeend",l),t.querySelector(".buttonwrapper").insertAdjacentHTML("beforeend",l)}if(e.matches(".tabcontent")){e.classList.add("hidden");let t=e.closest(".clone_divs_wrapper").querySelector(".tablink.active"),l=o(t);t.classList.remove("active"),t.parentNode.insertBefore(l,t.nextSibling)}return e.parentNode.insertBefore(t,e.nextSibling),t}function c(e){function t(e,t){""!=e.id&&(e.id=e.id.replace(/[0-9]+(?!.*[0-9])/,t)),"button"==e.type&&""!=e.textContent&&(e.textContent=e.textContent.replace(/[0-9]+(?!.*[0-9])/,t+1),e.dataset.target=e.dataset.target.replace(/[0-9]+(?!.*[0-9])/,t)),null!=e.dataset.divid&&(e.dataset.divid=t),e.querySelectorAll("h3, h4, legend :first-child").forEach((e=>{e.textContent=e.textContent.replace(/[0-9]+(?!.*[0-9])/,t+1)})),e.querySelectorAll("input,select,textarea").forEach((e=>{e.classList.contains("nice-select-search")||(""!=e.id&&null!=e.id&&(e.id=e.id.replace(/[0-9]+(?!.*[0-9])/,t)),""!=e.name&&null!=e.name&&(e.name=e.name.replace(/[0-9]+(?!.*[0-9])/,t)),"button"==e.type&&(e.value=e.value.replace(/[0-9]+(?!.*[0-9])/,t)))}))}e.querySelectorAll(":scope > .clone_div").forEach(t),e.querySelectorAll(":scope > .tablink").forEach(t)}function i(e){let t=e.closest(".clone_div"),l=t.closest(".clone_divs_wrapper"),n=l.querySelectorAll(".clone_div");if(n[n.length-1]==t){let e=t.querySelector(".add"),l=t.previousElementSibling;null==l.querySelector(".buttonwrapper .add")&&l.querySelector(".buttonwrapper").appendChild(e)}t.remove(),1==l.querySelectorAll(".clone_div").length&&l.querySelector(".remove").remove(),c(l)}function s(e,t,l,n,r="",o=!1){if(null==t)return;let d="",u="";if(e instanceof Element)u=e,d=u.name,e=""==u.id?`[name^="${u.name}" i]`:`[id^=${u.id}]`;else{u=n.querySelector(e);try{d=u.name}catch{console.log(u)}}let m=function(e,t,l=!0,n=null,r=!1){let o="",a="",c="",i="";return e instanceof Element?(o=e,"INPUT"!=o.tagName&&"TEXTAREA"!=o.tagName&&"SELECT"!=o.tagName&&null==o.closest(".nice-select-dropdown")&&(o=o.querySelector("input, select, textarea")),null==o&&(o=e),a=o.name):e.match("E[0-9]")?(i=`[id^=${e}]`,o=t.querySelector(i),a=o.name):(a=e,i=`[name='${a}' i]`,o=t.querySelector(i)),null==o?(console.trace(),console.log("cannot find element with name "+a),c):("radio"==o.type?c=function(e,t){let l=e.querySelector(`${t}:checked`);return null==l?"":l.value}(t,i):"checkbox"==o.type?c=function(e,t,l,n){let r="",o="";return"checkbox"==n.type&&null!=l?n.checked?n.value:"":(null!=l?(o=e.querySelector(`${t}[value="${l}" i]:checked`),null!=o&&(r=l)):(o=e.querySelectorAll(`${t}:checked`),r=[],o.forEach((e=>{r.push(e.value)}))),r)}(t,i,n,e):null!=o.closest(".nice-select-dropdown")&&null!=o.dataset.value?c=o.dataset.value:null!=o.list&&""!=o.value&&l?c=function(e){let t="",l=e.list.querySelector(`[value='${e.value}' i]`);return t=null==l?e.value:l.dataset.value,t}(o):null!=o.name&&o.name.endsWith("[]")?c=function(e,t){let l=[];return e.querySelectorAll(`[name="${t.name}"]`).forEach((e=>l.push(e.value))),l}(t,o):null!=o.value&&"undefined"!=o.value&&(c=o.value),r?c.toLowerCase():c)}(u,n,!1,t);if(m==t)return;if(null==u){let e=n.querySelectorAll(`.clone_div [name^="${d}" i]`);if(0===e.length)return;1==e.length?(u=e[0],e=""):(u=e[0],e.forEach(((e,t)=>{0==t?s(e,"","",n):i(e)})))}if(""!=r)if(/\d{4}-\d{2}-\d{2}/.test(t)){let e=new Date(t);e.setDate(e.getDate()+parseInt(r)),t=e.toISOString().split("T")[0]}else t+=parseInt(r);if("radio"==u.type||"checkbox"==u.type)if(""==t)""!=e&&n.querySelectorAll(e).forEach((e=>e.checked=!1));else if(u.value.toLowerCase()==t.toLowerCase())u.checked=!0;else{let e=n.querySelectorAll(`[name="${d}" i]`);for(const l of e)l.value.toLowerCase()==t.toLowerCase()&&(l.checked=!0)}else if("date"==u.type){if(u.value=t,!/\d{4}-\d{2}-\d{2}/.test(t)){let e="";if(3==t.split("-").length?e=t.split("-"):3==t.split("/").length&&(e=t.split("/")),""!=e){let t,l,n;e.forEach((e=>{4==e.length?t=e:2==e.length&&(e>12?n=e:null==l?l=e:n=e)})),null!=n&&null!=l&&null!=t&&(u.value=`${t}-${l}-${n}`)}}}else if(null!=u.list){let e=u.list.querySelector(`[data-value="${t}" i]`);if(null!=e)if(null!=u.closest(".clone_div")){let t;u.closest(".clone_divs_wrapper").querySelectorAll(".clone_div").forEach((e=>e.classList.add("shouldremove"))),e.value.split(";").forEach((e=>{t=a(u.closest(".clone_div")),t.classList.remove("shouldremove"),s(t.querySelector(u.tagName),e,"",n,"",!0)})),c(u.closest(".clone_divs_wrapper")),u.closest(".clone_divs_wrapper").querySelectorAll(".shouldremove").forEach((e=>e.remove()))}else u.value=e.value;else u.value=o?t:""}else u.value=t;let f=new Event("input");u.dispatchEvent(f),"function"==typeof l&&l(u)}async function d(e){let t=e.closest(".form.table-wrapper"),l=e.outerHTML,n=new FormData,r=t.querySelector(".sim-table.form-data-table").dataset.formid,o=t.querySelector(".sim-table.form-data-table").dataset.shortcodeid;n.append("formid",r),n.append("shortcode_id",o);const a=new URL(window.location);a.searchParams.get("onlyown")&&n.append("onlyown",!0),a.searchParams.get("all")&&n.append("all",!0),a.searchParams.get("archived")&&n.append("archived",!0);let c=Main.showLoader(e,!1,"Requesting form results...");t.innerHTML=c.outerHTML;let i=await FormSubmit.fetchRestApi("forms/show_form_results",n);i?t.innerHTML=i:c.outerHTML=l}window.addEventListener("online",(function(){document.querySelectorAll(".form_submit").forEach((e=>{e.disabled=!1,e.querySelectorAll(".offline").forEach((e=>e.remove()))}))})),window.addEventListener("offline",(function(){document.querySelectorAll(".form_submit").forEach((e=>{e.disabled=!0,null==e.querySelector(".online")&&(e.innerHTML='<div class="online">'+e.innerHTML+"</div>"),e.innerHTML+='<div class="offline">You are offline</div>'}))})),document.addEventListener("click",(function(t){let n=t.target;if(n.matches(".add")){let e=n.closest(".clone_div"),t=a(e);c(n.closest(".clone_divs_wrapper")),t.querySelectorAll(".wp-editor-area").forEach(((t,l)=>{let n=tinymce.get(e.querySelectorAll(".wp-editor-area")[l].id);if(null!=n){let e=n.settings;for(const t in e)console.log(`${t}: ${e[t]}`),"string"==typeof e[t]&&(e[t]=e[t].replace(/(.*)([0-9])/,((e,t,l)=>t+(parseInt(l)+1))));tinymce.init(e)}})),n.remove()}n.matches(".remove")&&i(n),n.matches('.sim-form-wrapper [name="submit_form"]')&&(t.stopPropagation(),async function(e){let t=e.closest("form");t.querySelectorAll(".required:not(hidden) input, .required:not(hidden) textarea, .required:not(hidden) select").forEach((e=>{null!=e.closest("div.nice-select")||"file"==e.type&&null!=e.closest(".file_upload_wrap").querySelector(".documentpreview input")||(e.required=!0)}));let l=await FormSubmit.submitForm(e,"forms/save_form_input");l&&(e.closest(".submit_wrapper").querySelector(".loadergif").classList.add("hidden"),Main.displayMessage(l),"true"==t.dataset.reset&&FormSubmit.formReset(t))}(n)),(n.matches(".formbuilder-switch")||n.matches(".formbuilder-switch-back"))&&async function(t){let n,r=t.closest(".sim-form-wrapper"),o=t.outerHTML,a=new FormData;const c=new URL(window.location);t.matches(".formbuilder-switch")?(a.append("formbuilder",!0),c.searchParams.set("formbuilder",!0),n=r.querySelector("form.sim-form-wrapper").dataset.formid):(c.searchParams.delete("formbuilder"),n=r.querySelector('[name="formid"]').value),window.history.pushState({},"",c),a.append("formid",n);let i=Main.showLoader(t,!1,"Requesting form...");r.innerHTML=i.outerHTML;let s=await FormSubmit.fetchRestApi("forms/form_builder",a);s?(r.innerHTML=s.html,function(t,n){e=[];let r=document.createElement("div");r.innerHTML=t.html,e=Array.prototype.slice.call(r.getElementsByTagName("script")),t.js&&(r.innerHTML=t.js,e=[...r.children].concat(e),l(n)),t.css&&(r.innerHTML=t.css,[...r.children].forEach((e=>{document.head.appendChild(e)})))}(s,document)):i.outerHTML=o}(n),(n.matches(".archive-switch-hide")||n.matches(".archive-switch-show"))&&async function(e){const t=new URL(window.location);e.matches(".archive-switch-show")?t.searchParams.set("archived",!0):t.searchParams.delete("archived"),window.history.pushState({},"",t),d(e)}(n),(n.matches(".onlyown-switch-all")||n.matches(".onlyown-switch-on"))&&async function(e){const t=new URL(window.location);e.matches(".onlyown-switch-on")?(t.searchParams.set("onlyown",!0),t.searchParams.delete("all",!0)):(t.searchParams.set("all",!0),t.searchParams.delete("onlyown")),window.history.pushState({},"",t),d(e)}(n)})),document.addEventListener("change",(e=>{if(e.target.matches("input[list]")&&e.target.name.includes("[")){let t=e.target.list.querySelector(`[value="${e.target.value}" i]`);if(null!=t){let l=t.dataset.value;null!=l&&s(e.target,l,"",e.target.closest("form"))}}})),document.addEventListener("click",(function(e){let t=e.target;t.matches(".add")&&(a(t.closest(".clone_div")),c(t.closest(".clone_divs_wrapper")),t.remove()),t.matches(".remove")&&(console.log(t),i(t))}))})();
//# sourceMappingURL=admin.min.js.map